<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Grepolis Mini</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #eef;
      margin: 0;
      padding: 20px;
    }
    h1, h2 {
      margin-top: 0;
    }
    .section {
      background-color: #fff;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    button, input[type="number"] {
      padding: 5px;
      margin: 5px;
    }
    #log {
      background: #222;
      color: #0f0;
      padding: 10px;
      height: 150px;
      overflow-y: auto;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <h1>Grepolis Mini</h1>
  
  <div class="section">
    <h2>Zasoby</h2>
    <p>Drewno: <span id="wood">0</span> | Kamie≈Ñ: <span id="stone">0</span> | ≈ªo≈Çnierze: <span id="soldiers">0</span> / <span id="maxSoldiers">100</span></p>
    <p>LVL: <span id="level">1</span> <span id="xp">0</span>/<span id="xpNeeded">100</span> XP | Z≈Çoto: <span id="gold">0</span></p>
  </div>

  <div class="section">
    <h2>Gie≈Çda zasob√≥w</h2>
    <p>Tutaj wymienisz swoje zasoby</p>
    <p>Kurs wymiany 2:1</p>
    <input type="number" id="woodexchange" placeholder="Ile drewna?" min="2">
    <button onclick="exchangewood()">Wymie≈Ñ drewno</button>
    <input type="number" id="stoneexchange" placeholder="Ile kamienia?" min="2">
    <button onclick="exchangestone()">Wymie≈Ñ kamie≈Ñ</button>
  </div>

  <div class="section">
    <h2>Twoje zarobki</h2>
    <p>Aby zaczƒÖƒá zarabiaƒá musisz wykupiƒá dostƒôp</p>
    <button onclick="unlockmonetization()">Kup dostƒôp (100 z≈Çota)</button>
    <p>Twoje aktualne zarobki:</p>
    <p id="pln">0</p>
    <p>Aby wyp≈Çaciƒá musisz zebraƒá 20 PLN.</p>
  </div>

  <div class="section">
    <h2>Budynki</h2>
    <p>Koszt rozbudowy to poziom do kt√≥rego chcesz rozbudowaƒá budynek * 100.</p>
    <p>Ob√≥z Drwali (Lv. <span id="woodCampLevel">1</span>) <button onclick="upgradeBuilding('woodCamp')">Ulepsz</button></p>
    <p>Kamienio≈Çom (Lv. <span id="stoneCampLevel">1</span>) <button onclick="upgradeBuilding('stoneCamp')">Ulepsz</button></p>
    <p>Koszary (Lv. <span id="barracksLevel">1</span>) <button onclick="upgradeBuilding('barracks')">Ulepsz</button></p>
  </div>

  <div class="section">
    <h2>Trening ≈ºo≈Çnierzy</h2>
    <p>Koszt jednego ≈ºo≈Çnierza to po 30 drewna i kamienia.</p>
    <input type="number" id="soldierCountInput" placeholder="Ilu ≈ºo≈Çnierzy?" min="1"/>
    <button onclick="trainSoldiers()">Rekrutuj</button>
  </div>

  <div class="section">
    <h2>Najazdy</h2>
    <select id="raidSelect"></select>
    <input type="number" id="raidSoldiers" placeholder="Ilu ≈ºo≈Çnierzy?" min="1">
    <button onclick="sendRaid()">Wy≈õlij najazd</button>
    <div id="log"></div>
  </div>

  <div class="section">
    <h2>Sklep premium</h2>
    <p>Z≈Çoto: <span id="premiumgold">0</span></p>
    <button onclick="buywood()">Kup drewno (10,000)</button>
    <button onclick="buystone()">Kup kamie≈Ñ (10,000)</button>
    <button onclick="buysoldiers()">Kup ≈ºo≈Çnierzy (1,000)</button>
    <p><strong>100 z≈Çota = 1.00 PLN</strong></p>
    <!-- <button onclick="addGold(100)">Pole Administracji</button> -->
    <input id="goldCode" placeholder="Wpisz kod...">
    <button onclick="checkGoldCode()">Zatwierd≈∫ kod</button>
  </div>

  <div id="saveLoadPanel">
    <h3>Zapis i Wczytywanie Gry</h3>
    <button onclick="saveGame()">üíæ Zapisz grƒô</button>
    <button onclick="loadGame()">üìÇ Wczytaj grƒô</button>
  </div>

  <script>
    let wood = 0, stone = 0, soldiers = 0, gold = 100, xp = 0, level = 1, pln = 0, allowed = 0;
    let woodCampLevel = 1, stoneCampLevel = 1, barracksLevel = 1;
    const logBox = document.getElementById("log");

    const raids = [
      { name: "Najazd Lv. 1 (1‚Äì49)", levelReq: 1, max: 100 },
      { name: "Najazd Lv. 2 (50‚Äì99)", levelReq: 50, max: 300 },
      { name: "Najazd Lv. 3 (100‚Äì199)", levelReq: 100, max: 500 },
      { name: "Najazd Lv. 4 (200‚Äì299)", levelReq: 200, max: 1000 },
      { name: "Najazd Lv. 5 (300+)", levelReq: 300, max: Infinity }
    ];

    raids.forEach((r, i) => {
      const opt = document.createElement("option");
      opt.value = i;
      opt.textContent = r.name + " (max " + (r.max === Infinity ? "‚àû" : r.max) + ")";
      document.getElementById("raidSelect").appendChild(opt);
    });

    function updateUI() {
      document.getElementById("wood").textContent = wood;
      document.getElementById("stone").textContent = stone;
      document.getElementById("soldiers").textContent = soldiers;
      document.getElementById("gold").textContent = gold;
      document.getElementById("premiumgold").textContent = gold;
      document.getElementById("pln").textContent = pln.toFixed(2) + ' PLN';
      document.getElementById("level").textContent = level;
      document.getElementById("xp").textContent = xp;
      document.getElementById("xpNeeded").textContent = level * 100;
      document.getElementById("woodCampLevel").textContent = woodCampLevel;
      document.getElementById("stoneCampLevel").textContent = stoneCampLevel;
      document.getElementById("barracksLevel").textContent = barracksLevel;
      document.getElementById("maxSoldiers").textContent = barracksLevel < 10 ? barracksLevel * 100 : '‚àû';
    }

    function log(msg) {
      logBox.textContent += msg + "\n";
      logBox.scrollTop = logBox.scrollHeight;
    }

    function upgradeBuilding(type) {
      let level = type === 'woodCamp' ? woodCampLevel : type === 'stoneCamp' ? stoneCampLevel : barracksLevel;
      if (wood >= (level + 1) * 100 && stone >= (level + 1) * 100) {
        wood -= (level + 1) * 100;
        stone -= (level + 1) * 100;
        if (type === 'woodCamp') woodCampLevel++;
        else if (type === 'stoneCamp') stoneCampLevel++;
        else if (type === 'barracks' && barracksLevel < 10) barracksLevel++;
        updateUI();
      }
    }


    function trainSoldiers() {
        let recruit = parseInt(document.getElementById("soldierCountInput").value);
        let woodcost = recruit * 30;
        let stonecost = recruit * 30;
        if (woodcost <= wood && stonecost <= stone && barracksLevel < 10 && recruit <= barracksLevel * 100 - soldiers) {
            soldiers += recruit;
            wood -= woodcost;
            stone -= stonecost;
            window.alert('Zrekrutowano ' + recruit + ' zolnierzy!');
        }
        else if (woodcost <= wood && stonecost <= stone && barracksLevel === 10) {
            soldiers += recruit;
            wood -= woodcost;
            stone -= stonecost;
            window.alert('Zrekrutowano ' + recruit + ' zolnierzy!');
        }
        else if (woodcost > wood || stonecost > stone || recruit > barracksLevel * 100 - soldiers) {
            window.alert('Nie masz odpowiednio duzo surowcow, lub nie masz wystarczajaco duzo miejsca w koszarach!')
        }
    }

    function sendRaid() {
      const raid = raids[document.getElementById("raidSelect").value];
      const send = parseInt(document.getElementById("raidSoldiers").value);
      if (level < raid.levelReq) return log("Za niski poziom!");
      if (send > soldiers) return log("Nie masz tylu ≈ºo≈Çnierzy!");
      if (send > raid.max) return log("Za du≈ºo ≈ºo≈Çnierzy na ten najazd!");
      let xpGain = 0, woodGain = 0, stoneGain = 0, survived = 0;
      for (let i = 0; i < send; i++) {
        xpGain += Math.floor(Math.random() * 5) + 1;
        woodGain += 3;
        stoneGain += 3;
        if (Math.random() < 0.5) survived++;
      }

      if (pln >= 0 && pln < 5 && allowed === 1) {
        if (Math.random() < 0.5) {
          pln += 0.01;
        }
      }
      if (pln >= 5 && pln < 10 && allowed === 1) {
        if (Math.random() < 0.3) {
          pln += 0.01;
        }
      }
      if (pln >= 10 && pln < 15 && allowed === 1) {
        if (Math.random() < 0.05) {
          pln += 0.01;
        }
      }
      if (pln >= 15 && pln < 19 && allowed === 1) {
        if (Math.random() < 0.01) {
          pln += 0.01;
        }
      }
      if (pln >= 19 && pln < 19.86 && allowed === 1) {
        if (Math.random() < 0.0001) {
          pln += 0.01;
        }
      }

      soldiers -= send;
      soldiers += survived;
      wood += woodGain;
      stone += stoneGain;
      xp += xpGain;
      while (xp >= level * 100) {
        xp -= level * 100;
        level++;
        log("Awans! Nowy poziom: " + level);
      }
      log("Najazd: wys≈Çano " + send + ", prze≈ºy≈Ço " + survived + ", XP: " + xpGain + ", surowce: " + woodGain + "/" + stoneGain);
      updateUI();
    }
    
    function exchangewood() {
      const exchangequantitywood = parseInt(document.getElementById("woodexchange").value, 10);
      if (Number.isInteger(exchangequantitywood / 2) && exchangequantitywood <= wood) {
        stone += exchangequantitywood / 2;
        wood -= exchangequantitywood;
      }
      else if (!Number.isInteger(exchangequantitywood / 2) && exchangequantitywood <= wood) {
        stone += exchangequantitywood / 2 - 0.5;
        wood -= exchangequantitywood;
      }
      else if (exchangequantitywood > wood) {
        window.alert('Nie masz tyle drewna!')
      }
    }
    
    function exchangestone() {
      const exchangequantitystone = parseInt(document.getElementById("stoneexchange").value, 10);
      if (Number.isInteger(exchangequantitystone / 2) && exchangequantitystone <= stone) {
        wood += exchangequantitystone / 2;
        stone -= exchangequantitystone;
      }
      else if (!Number.isInteger(exchangequantitystone / 2) && exchangequantitystone <= stone) {
        wood += exchangequantitystone / 2 - 0.5;
        stone -= exchangequantitystone;
      }
      else if (exchangequantitystone > stone) {
        window.alert('Nie masz tyle kamienia!');
      }
    }

    function addGold(amount) {
      gold += amount;
      updateUI();
    }

    function checkGoldCode() {
      const now = new Date();
      const code = document.getElementById("goldCode").value;
      const hour = now.getHours().toString().padStart(2, '0');
      const min = now.getMinutes().toString().padStart(2, '0');
      if (code === "ADDGOLD" + hour + min) {
        gold += 100;
        updateUI();
      }
    }

    setInterval(() => {
      wood += woodCampLevel * 10;
      stone += stoneCampLevel * 10;
      updateUI();
    }, 1000);

    function buywood() {
        if (gold >= 100) {
            gold -= 100;
            wood += 10000;
            window.alert('Pomyslnie zakupiono 10,000 drewna!');
        }
        else if (gold < 100) {
            window.alert('Nie masz wystarczajaco duzo zlota, aby sfinalizowaƒá ta transakcje');
        }
    }

    function buystone() {
        if (gold >= 100) {
            gold -= 100;
            stone += 10000;
            window.alert('Pomyslnie zakupiono 10,000 kamienia!');
        }
        else if (gold < 100) {
            window.alert('Nie masz wystarczajaco duzo zlota, aby sfinalizowaƒá ta transakcje');
        }
    }

    function buysoldiers() {
        if (gold >= 100 && barracksLevel * 100 - soldiers >= 1000) {
            gold -= 100;
            soldiers += 1000;
            window.alert('Pomyslnie zakupiono 1,000 zolnierzy!');
        }
        else if (gold < 100 || barracksLevel * 100 - soldiers < 1000) {
            window.alert('Nie masz wystarczajaco duzo zlota, aby sfinalizowaƒá ta transakcje, lub nie masz wystarczajaco duzo miejsca w koszarach aby pomiescic wszystkich zolnierzy!');
        }
    }
    function unlockmonetization() {
      if (gold >= 100 && allowed === 0) {
        gold -= 100;
        allowed = 1
        window.alert('Pomyslnie odblokowano zarabianie!')
      }
      else if (gold < 1000 || allowed === 1) {
        window.alert('Masz za malo zlota, lub ta usluga zostala juz przez ciebie zakupiona!')
      }
    }
    function saveGame() {
        const gameData = {
            wood: wood,
            stone: stone,
            soldiers: soldiers,
            gold: gold,
            xp: xp,
            level: level,
            woodCampLevel: woodCampLevel,
            stoneCampLevel: stoneCampLevel,
            barracksLevel: barracksLevel,
            allowed: allowed,
            pln: pln
        };
        localStorage.setItem("myGrepolisSave", JSON.stringify(gameData));
        alert("Gra zosta≈Ça zapisana!");
    }

    function loadGame() {
        const saved = localStorage.getItem("myGrepolisSave");
        if (saved) {
            const gameData = JSON.parse(saved);
            wood = gameData.wood;
            stone = gameData.stone;
            soldiers = gameData.soldiers;
            gold = gameData.gold;
            xp = gameData.xp;
            level = gameData.level;
            woodCampLevel = gameData.woodCampLevel;
            stoneCampLevel = gameData.stoneCampLevel;
            barracksLevel = gameData.barracksLevel;
            allowed = gameData.allowed;
            pln = gameData.pln;
            alert("Gra zosta≈Ça wczytana!");
        } else {
            alert("Brak zapisu gry.");
        }
    }

    updateUI();
  </script>
</body>
</html>
